---
# Direct Immich chart configuration - values must be under immich: section
immich:
  persistence:
    library:
      existingClaim: "immich-ephemeral-pvc"

  server:
    ingress:
      main:
        enabled: true
        ingressClassName: nginx
        annotations:
          nginx.ingress.kubernetes.io/proxy-body-size: "0"
          nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
          nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
          cert-manager.io/cluster-issuer: "letsencrypt"
          cert-manager.io/common-name: "immich.internal.rmsz005.com"
        hosts:
          - host: immich.internal.rmsz005.com
            paths:
              - path: /
                pathType: Prefix
        tls:
          - hosts:
              - immich.internal.rmsz005.com
            secretName: immich-tls

image:
  tag: "v1.139.2"

# Enable PostgreSQL with ephemeral storage for testing
postgresql:
  enabled: true
  global:
    postgresql:
      auth:
        username: immich
        database: immich
        password: immich-test-password
  primary:
    persistence:
      enabled: false
    initdb:
      scripts:
        create-extensions.sql: |
          CREATE EXTENSION IF NOT EXISTS cube;
          CREATE EXTENSION IF NOT EXISTS earthdistance;
          CREATE EXTENSION IF NOT EXISTS vectors;

redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false
  master:
    persistence:
      enabled: false

# PVC is created by immich-storage ArgoCD application